rules:
  # ============================================
  # Execution Rules (exec)
  # ============================================
  - name: Reverse Shell Pattern
    description: Bash spawned by network service may indicate reverse shell
    severity: warning
    match:
      process_name: bash
      process_name_type: exact
      parent_name: nc
      parent_name_type: contains
    action: alert
    type: exec
  - name: Shell from Web Server
    description: Shell execution from web server process
    severity: warning
    match:
      process_name: bash
      process_name_type: exact
      parent_name: apache
      parent_name_type: contains
    action: alert
    type: exec
  - name: Shell from Nginx
    description: Shell execution from nginx process
    severity: warning
    match:
      process_name: bash
      process_name_type: exact
      parent_name: nginx
      parent_name_type: contains
    action: alert
    type: exec

  # ============================================
  # File Access Rules (file)
  # `filename` accepts absolute paths, relative paths,
  # or simple wildcards such as "logs/*".
  # ============================================
  - name: Block Password File
    description: Prevent any access to /etc/shadow
    severity: critical
    match:
      filename: /etc/shadow
    action: block
    type: file
  - name: Monitor Project Docs
    description: Alert on reads inside docs/
    severity: warning
    match:
      filename: docs/*
    action: alert
    type: file

  # ============================================
  # Network Connection Rules (connect)
  # action: block - actively blocks connections
  # action: alert - only monitors and alerts
  # ============================================
  - name: Block Reverse Shell Port
    description: Block connections to port 4444 (common reverse shell port)
    severity: critical
    match:
      dest_port: 4444
    action: block
    type: connect
  - name: Monitor C2 Port
    description: Monitor connections to port 8080 (commonly used for C2)
    severity: warning
    match:
      dest_port: 8080
    action: alert
    type: connect
