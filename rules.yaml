rules:
  - name: "Detect Bash Execution"
    description: "Detect bash shell execution, which may indicate an interactive session or script execution"
    severity: "info"
    match:
      process_name: "bash"
    action: "alert"

  - name: "Detect Suspicious Shell Execution"
    description: "Detect sh shell execution, commonly seen in malicious scripts"
    severity: "warning"
    match:
      process_name: "sh"
    action: "alert"

  - name: "Detect Bash in Container"
    description: "Detect bash execution in container, which may indicate container escape or unauthorized access"
    severity: "high"
    match:
      process_name: "bash"
      in_container: true
    action: "alert"

  - name: "Detect Python Execution"
    description: "Detect Python interpreter execution"
    severity: "info"
    match:
      process_name: "python"
    action: "alert"

  - name: "Detect Docker Command"
    description: "Detect docker command execution, which may indicate container management activity"
    severity: "warning"
    match:
      process_name: "docker"
    action: "alert"

  - name: "Detect Curl Download"
    description: "Detect curl command, which may be used to download malicious files"
    severity: "warning"
    match:
      process_name: "curl"
    action: "alert"

  - name: "Detect Wget Download"
    description: "Detect wget command, which may be used to download malicious files"
    severity: "warning"
    match:
      process_name: "wget"
    action: "alert"

  # File Access Rules
  - name: "Access to /etc/shadow"
    description: "Attempt to access /etc/shadow file, which contains password hashes"
    severity: "high"
    match:
      filename: "/etc/shadow"
    action: "alert"

  - name: "Access to /etc/passwd"
    description: "Access to /etc/passwd file, which contains user account information"
    severity: "warning"
    match:
      filename: "/etc/passwd"
    action: "alert"

  - name: "Access to /etc/sudoers"
    description: "Access to /etc/sudoers file, which controls sudo privileges"
    severity: "high"
    match:
      filename: "/etc/sudoers"
    action: "alert"

  - name: "Access to SSH Keys"
    description: "Access to SSH private keys in /root/.ssh/"
    severity: "high"
    match:
      file_path: "/root/.ssh/"
    action: "alert"

  - name: "Access to User Home Directories"
    description: "Access to files in user home directories"
    severity: "info"
    match:
      file_path: "/home/"
    action: "alert"

  - name: "Access to /etc/hosts"
    description: "Modification of /etc/hosts file, which may indicate DNS hijacking"
    severity: "warning"
    match:
      filename: "/etc/hosts"
    action: "alert"

